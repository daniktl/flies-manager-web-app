{% extends 'base.html' %}

{% block title %}
    {% if user %}
        {{ user.imie }} {{ user.nazwisko }}
    {% else %}
        Moje konto
    {% endif %}
{% endblock %}

{% block header %}
    <div class="container">
        <div class="header-text">
            {% if user %}
                Użytkownik {{ user.imie }} {{ user.nazwisko }}
            {% else %}
                Moje konto
            {% endif %}
        </div>
    </div>

{% endblock %}

{% block content %}
    <div class="subsection-header">
        {% if user %}
            Podróży użytkownika
        {% else %}
            Twoje podrózy
        {% endif %}
    </div>
    <table class="table table-sm table-hover">
        <thead>
        <tr>
            <th>
                Data
            </th>
            <th>
                Godzina
            </th>
            <th>
                Skąd
            </th>
            <th>
                Dokąd
            </th>
            <th>
                Cena
            </th>
            <th>
                Data zamówienia
            </th>
            <th>

            </th>

        </tr>
        </thead>
        <tbody>
        <tr>
            <th>
                1.11.2019
            </th>
            <th>
                10:15
            </th>
            <th>
                Poznań
            </th>
            <th>
                Warszawa
            </th>
            <th>
                150 PLN
            </th>
            <th>
                1.1.2019
            </th>
            <th>
                <button class="more-button action-button"></button>
            </th>

        </tr>
        <tr>
            <th>
                10.11.2019
            </th>
            <th>
                10:15
            </th>
            <th>
                Poznań
            </th>
            <th>
                Warszawa
            </th>
            <th>
                100 PLN
            </th>
            <th>
                2.4.2019
            </th>
            <th>
                <button class="more-button action-button"></button>
            </th>
        </tr>
        <tr>
            <th>
                1.12.2019
            </th>
            <th>
                14:00
            </th>
            <th>
                Warszawa
            </th>
            <th>
                Poznań
            </th>
            <th>
                15 PLN
            </th>
            <th>
                3.8.2019
            </th>
            <th>
                <button class="more-button action-button"></button>
            </th>
        </tr>
        </tbody>

    </table>


    {% if user %}
        <div class="btn-div right">
            <button class="png-btn new-btn" type="button" data-toggle="collapse" data-target="#collapseNewData"
                    aria-expanded="false" aria-controls="collapseNewData">
            </button>
        </div>
        <form class="collapse collapse-new" id="collapseNewData" method="post" enctype="multipart/form-data">
            <div class="card card-body">
                <div class="subsection-header">Nowy rabat</div>
                <div class="form-row">
                    <label for="procent">Zniżka</label>
                    <div class="input-group mb-3">
                        <input type="number" class="form-control" id="procent" name="procent" value="30">
                        <div class="input-group-append">
                            <span class="input-group-text">%</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="data_waznosci">Data ważności</label>
                    <input id="data_waznosci" name="data_waznosci" type="date" class="form-control">
                </div>

                <button type="submit" class="btn btn-primary btn-block" name="new" value="{{ u_id }}">Dodaj</button>
            </div>
        </form>
        <div class="subsection-header">
        Rabaty użytkownika

    {% else %}
        <div class="subsection-header">
        Twoje rabaty
    {% endif %}
</div>
    {% if not rabaty %}
    <div class="no-content"></div>
    {% else %}
<table class="table table-sm table-hover">
    <thead>
    <tr>
        <th>
            Kod rabatowy
        </th>
        <th>
            Procent zniżki
        </th>
        <th>
            Data ważności
        </th>
        <th>
            Skopiuj
        </th>
        <th>

        </th>

    </tr>
    </thead>
    <tbody>
    {% for rabat in rabaty %}
    <tr>
        <th>
            <div id="code_{{ rabat.kod }}" class="copy-area">
                {{ rabat.kod }}
            </div>

        </th>
        <th>
            {{ rabat.procent }}%
        </th>
        <th>
            {{ rabat.get_data_waznosci() }}
        </th>

        <th>
            <input type="button" class="copy-button action-button" data-placeholder="code_{{ rabat.kod }}">
        </th>
        <th>
            <button class="more-button action-button" data-toggle="modal"
                                data-target="#modal-rabat-{{ rabat.kod }}"></button>
        </th>

    </tr>
    {% endfor %}

    </tbody>

</table>
    {% endif %}

    {% for rabat in rabaty %}

        <div class="modal fade" id="modal-rabat-{{ rabat.kod }}" tabindex="-1" role="dialog"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <form class="modal-content" method="post" enctype="multipart/form-data">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalCenterTitle">Rabat {{ rabat.kod }}</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <table class="table">
                                <tbody>
                                <tr>
                                    <th>
                                        Kod rabatowy
                                    </th>
                                    <th>
                                        {{ rabat.kod }}
                                    </th>
                                </tr>
                                <tr>
                                    <th>
                                        Procent zniżki
                                    </th>
                                    <th>
                                        {{ rabat.procent }}%
                                    </th>
                                </tr>
                                <tr>
                                    <th>
                                        Data ważności
                                    </th>
                                    <th>
                                        {{ rabat.get_data_waznosci() }}
                                    </th>

                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-danger" name="remove-rabat" value="{{ rabat.kod }}">Usuń
                            </button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Zamknij</button>
                        </div>
                    </form>
                </div>
            </div>

    {% endfor %}

{% endblock %}